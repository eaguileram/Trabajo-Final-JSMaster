<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StoreLand</title>
    <!-- Fuentes Google -->
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Alegreya+Sans+SC:100,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700&display=swap" rel="stylesheet">
    <style>
      * {
          box-sizing: border-box;
          padding: 0;
          margin: 0;
          color: #7e7e85;
        }

      body {
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        font-size: 16px;
        text-align: center;
        max-width: 1920px;
        background: #f0f0f0;
      }

      ul {
        list-style: none;
      }
      .grid {
        display: grid;
        grid-template-columns: 3fr 1fr;
        grid-template-areas: "article sidebar-2";
      }

      article{
        background: #f0f0f0;
        padding: 1em;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        grid-template-rows: 0fr;
      }

      article > img, figcaption, span > button{
        display: block;
        text-align: center;
      }

      .sidebar-right {
        grid-area: sidebar-2;
        background-color: #dedede;
        padding: 1em;
        
      }

      .producto{
        font-family: "Raleway",sans-serif;
        font-size: .8rem;
        font-weight: 500;
        height: 400px;
        background-color: #fff;
        padding: 1em;
        margin: 1em;
        border: 3px;
        line-height: 1.6;
        border-radius: .1875rem;
        transition: all .5s;
        display: block;
      }

      .producto:hover{
        box-shadow: 0px 5px 43px rgb(0 0 0 / 11%) !important;
      }

      img{
        width:  200px;
        height: 200px;
      }
      
      figcaption{
        text-transform: uppercase;
        font-weight: 500;
      }

      .precio{
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        font-size: 120%;
        font-weight: 500;
        color: #0023ff;
      }
      
      .stock{
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        color: #999;
        font-size: 100%;
        font-weight: 300;
      }

      .encarrito{
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        color: #999;
        font-size: 100%;
        font-weight: 300;
      }

      button{
        margin-top: 10px;
        margin-bottom: 10px;
      }

      .btnagregar{
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        background-color: #0023ff;
        color: #fff;
        border: 1px solid #0023ff;
        font-size: 1.05em;
        font-weight: bold;
        height: 42px;
        border-radius: 500px;
        padding: 10px;
        min-width: 65%;
        transition: all .5s;
      }

      .btnagregar:hover {
        -webkit-box-shadow: 0 14px 26px -12px rgb(0 35 255 / 42%), 0 4px 23px 0px rgb(0 0 0 / 12%), 0 8px 10px -5px rgb(0 35 255 / 20%) !important;
        box-shadow: 0 14px 26px -12px rgb(0 35 255 / 42%), 0 4px 23px 0px rgb(0 0 0 / 12%), 0 8px 10px -5px rgb(0 35 255 / 20%) !important;
        opacity: .9 .5;
        cursor: pointer;
      }

      .asidebox{
        padding: 30px 30px 20px 30px;
        width: 100%;
        background: #fff;
        border-radius: 8px;
        border: 1px solid #cecece;
        padding: 20px;
        margin-bottom: 20px;
      }

      .asideboxArticulo {
        padding: 30px 30px 10px 10px;
        width: 100%;
        background: #fff;
        border-bottom: 1px solid #dedede;
        }

      .userbox{
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }

      .avatarbox>img{
        position: relative;
        height: 44px;
        width: 44px;
        min-width: 44px;
        display: block;
        border-radius: 50%;
        height: auto;
        max-width: 100%;
      }

      .metadata{
        margin-left: 12px;
        text-align: left;
      }

      .metadata span:first-child {
          font-family: Montserrat;
          font-size: .7rem;
          font-weight: 600;
          color: #999;
          text-transform: uppercase;
          display: block;
      }

      .metadata span:nth-child(2) {
          font-family: "Montserrat",sans-serif;
          font-weight: 600;
          color: #4a4a4a;
          font-size: .9rem;
      }      

      .metadataArticulo {
        font-size: 70%;
        font-weight: 500;
        text-transform: uppercase;
        color: #828282;
        text-align: left;
        line-height: 1.5;
        padding-left: .6em;
        width: 100%;
      }

      .avatarcart>img{
        position: relative;
        height: 88px;
        width: 88px;
        min-width: 44px;
        display: block;
        border-radius: 50%;
        height: auto;
        max-width: 100%;
      }  

      .metadataArticulo span:nth-child(2) {
        font-family: "Monserrat",sans-serif;
        font-size: 1.1em;
        font-weight: 500;
        text-transform: lowercase;
        color: #7e7e85;
        display: block;
        line-height: 1.3;
      }

      .metadataArticulo span:nth-child(3) {
        font-family: "Monserrat",sans-serif;
        font-size: 1.1em;
        font-weight: 500;
        text-transform: lowercase;
        color: #7e7e85;
        display: block;
        line-height: 1.3;
      }

      .metadataArticulo span:nth-child(4) {
        font-family: "Monserrat",sans-serif;
        font-size: 1em;
        font-weight: 700;
        text-transform: uppercase;
        color: #828282;
        display: block;
        line-height: 1.3;
      }

      .login,input{
        display: block;
        width: 100%;
        line-height: 2;
        border: none;
      }

      .boxinput {
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;display: flex; height: 44px; align-items: center; border:1px solid rgb(219, 219, 219); border-radius: .1875rem; margin-bottom: 10px;color: #363636;transition: all .6s;
      }

      input:focus {
        outline: none;
      }

      .boxicon {
        color: #dedede; padding-right: 14px; padding-left: 14px;
      }

      .boxiconcart {
        color: #dedede;  font-size: 1.1em; transition: .3s;
      }

      

      .boxiconcart:hover, i>fa {
        color: #0023ff; cursor:pointer; transition: .6s;
      }

      .bluecolor {
        color: blue!important;
        transition: all .6s;
      }

      .asidebox > span {
          font-family: "Montserrat";
          font-size: .73rem;
          font-weight: 600;
          color: #999;
          text-transform: uppercase;
          display: block;
          line-height: 4;
      }

      .cartbox{
        display: -webkit-box;
        display: -ms-flexbox;
        display: block;
        -webkit-box-align: left;
        -ms-flex-align: left;
        align-items: left;
      }

      .metadataCart{
        font-family: Montserrat;
        font-size: .7rem;
        font-weight: 600;
        color: #999;
        padding-bottom: 14px;
        align-items: left;
        display: block;
        line-height: 3;
        margin-bottom: -1em;
      }

      .cartNumber {
        font-weight: 900;
        font-size: 1.3em;
      }

      .titleCart {
        text-transform: uppercase;
      }

      .carticonbox {
        margin-bottom: -.2em;
      }  

      .precioDetalle {
        font-size: 80%;
      }

      .precioTotal {
        font-weight: bold;
      }

      .asideboxArticuloDetalle {
          padding: 10px 0px 0px 5px;
          background: #fff;
      }

      .titleDetalle {
          margin-top: 2em;
      }

      .titleBtn {
        font-family: "Montserrat";
        font-size: .73rem;
        font-weight: 600;
        color: #fff;
        text-transform: uppercase;
      }

      .boxshop {
        font-size: 2em;
      }

      .boxcheck {
        font-size: 2em;
        color: #0023ff;
        transition: .9s;
      }

      .titleCompra {
        margin-top: 2em;
      }

      .login-accounts-panel .panel-inner .login-block {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        padding: 12px 0;
        margin: 0 20px;
        cursor: pointer;
        align-items: center;
      }

      .login-accounts-panel .panel-inner .header {
        padding: 16px 20px 6px 20px;
        text-transform: uppercase;
        font-family: Montserrat;
        font-size: .7rem;
        font-weight: 600;
        color: #999;
        padding-bottom: 14px;
        align-items: left;
        display: block;
        line-height: 3;
        margin-bottom: -1em;    
      }

      .login-accounts-panel .panel-inner .header p {
        text-transform:lowercase;
        font-family: Montserrat;
        font-size: .7rem;
        font-weight: 600;
        color: #999;
        padding-bottom: 14px;
        align-items: left;
        display: block;
        line-height: 3;
        margin-bottom: -1em; 
      }

      .login-accounts-panel .panel-inner .login-block img {
        display: block;
        border-radius: 50%;
        height: 38px;
        width: 38px;
        -webkit-filter: grayscale(1);
        filter: grayscale(1);
        opacity: .6;
        -webkit-transition: all .3s;
        transition: all .3s;
      }

      .login-accounts-panel .panel-inner .login-block:hover img {
        -webkit-filter: grayscale(0);
        filter: grayscale(0);
        opacity: 1;
      }

      .login-accounts-panel .panel-inner .login-block .meta {
        margin-left: 12px;
        text-align: left;
        font-size: 80%;
        font-weight: 500;
      }

      .login-accounts-panel .panel-inner {
        position: relative;
        height: 100%;
        width: 100%;  
      }

      .login-accounts-panel.is-active {
        opacity: 1;
        -webkit-transform: translateY(0);
        transform: translateY(0);
        width: 100%;
      }

      .flbl {
        text-transform: uppercase;
        color: #999;
        font-size: .65rem;
        font-weight: 400;
      }

      .header h3 {
        text-align: center;
      }

      #toast {
        visibility: hidden;
        max-width: 50px;
        height: 50px;
        margin-left: -125px;
        margin: auto;
        background-color: #0023ff;
        color: #fff;
        text-align: center;
        border-radius: 2px;
        position: fixed;
        z-index: 1;
        left: 0;right:0;
        bottom: 30px;
        font-size: 17px;
        white-space: nowrap;
        border-radius: 30em;
      }
      #toast #img{
      	width: 50px;
      	height: 50px;
        float: left;
        padding-top: 16px;
        padding-bottom: 16px;
        box-sizing: border-box;    
        background-color: #0023ff;
        color: #fff;
        border-radius: 30em;
      }
      #toast #desc{
        color: #f0f0f0;
        padding: 16px;
        overflow: hidden;
      	white-space: nowrap;
      }

      #toast.show {
        visibility: visible;
        -webkit-animation: fadein 0.3s, expand 0.5s 0.5s,stay 4s 1s, shrink 0.5s 3s, fadeout 4s;
        animation: fadein 0.3s, expand 0.5s 0.5s,stay 4s 1s, shrink 0.5s 3s, fadeout 4s;
      }

      @-webkit-keyframes fadein {
        from {bottom: 0; opacity: 0;} 
        to {bottom: 30px; opacity: 1;}
      }

      @keyframes fadein {
        from {bottom: 0; opacity: 0;}
        to {bottom: 30px; opacity: 1;}
      }

      @-webkit-keyframes expand {
        from {min-width: 50px} 
        to {min-width: 250px}
      }

      @keyframes expand {
        from {min-width: 50px}
        to {min-width: 250px}
      }
      @-webkit-keyframes stay {
        from {min-width: 250px} 
        to {min-width: 250px}
      }

      @keyframes stay {
        from {min-width: 250px}
        to {min-width: 250px}
      }
      @-webkit-keyframes shrink {
        from {min-width: 250px;} 
        to {min-width: 50px;}
      }

      @keyframes shrink {
        from {min-width: 250px;} 
        to {min-width: 50px;}
      }

      @-webkit-keyframes fadeout {
        from {bottom: 30px; opacity: 1;} 
        to {bottom: 60px; opacity: 0;}
      }

      @keyframes fadeout {
        from {bottom: 30px; opacity: 1;}
        to {bottom: 60px; opacity: 0; }
      }

      .btnagregado {
        font-family: "Montserrat";
        color: #dedede;
        border: none;
        height: 42px;
        border-radius: 500px;
        padding: 10px;
        min-width: 65%;
        transition: all .5s;
        font-size: .73rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .main-cart-spinner {
        position: relative;
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: justify;
        -ms-flex-pack: justify;
        justify-content: space-around;
        align-content: center;
        padding: 10px;
        min-width: 100px;
        font-size: 80%;
        border: 1px solid #ededed;
        border-radius: 100px;
        margin-right: 3em;
        -webkit-box-shadow: -1px 3px 15px 0 rgb(0 0 0 / 6%);
        box-shadow: -1px 3px 15px 0 rgb(0 0 0 / 6%);
      }

      .boxCliente {
        display: none;
      }

      #hover {
       
        padding: 6px;
        display: block;
        position: relative;
      }

      #popup {
        font-family: BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif;
        opacity: 0;
        position: absolute;
        top: -40px;
        right: -10px;
        background: #344258!important;
        color: #fff !important;
        border: none;
        border-radius: 6px;
        height: 0px;
        padding: 0 12px;
        overflow: hidden;
        transition: all .6s;
        font-size: 70%;
        font-weight: 400;
        -webkit-box-shadow: 0 14px 26px -12px rgb(0 35 255 / 42%), 0 4px 23px 0px rgb(0 0 0 / 12%), 0 8px 10px -5px rgb(0 35 255 / 20%) !important;
        box-shadow: 0 14px 26px -12px rgb(0 35 255 / 42%), 0 4px 23px 0px rgb(0 0 0 / 12%), 0 8px 10px -5px rgb(0 35 255 / 20%) !important;
        opacity: .9 .5;
      }

      #hover:hover #popup {
          padding: 10px 10px;
          height: auto;
          opacity: 1;
          border:none;
      }
    
      .rock{
        border: none!important;
        background: transparent!important;
      }
      .rock::before {
          width: 50px;
          height: 50px;
          content: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20class%3D%22feather%20feather-trash-2%22%3E%3Cpolyline%20points%3D%223%206%205%206%2021%206%22%3E%3C%2Fpolyline%3E%3Cpath%20d%3D%22M19%206v14a2%202%200%200%201-2%202H7a2%202%200%200%201-2-2V6m3%200V4a2%202%200%200%201%202-2h4a2%202%200%200%201%202%202v2%22%3E%3C%2Fpath%3E%3Cline%20x1%3D%2210%22%20y1%3D%2211%22%20x2%3D%2210%22%20y2%3D%2217%22%3E%3C%2Fline%3E%3Cline%20x1%3D%2214%22%20y1%3D%2211%22%20x2%3D%2214%22%20y2%3D%2217%22%3E%3C%2Fline%3E%3C%2Fsvg%3E);
          border: none!important;
          background: transparent!important;
          }

      
 
    
      @media (min-width: 2000px) { article{ grid-template-columns: 1fr 1fr 1fr 1fr;} }
      @media (max-width: 1500px) { article{ grid-template-columns: 1fr 1fr;} }
      @media (max-width: 1200px) { article{ grid-template-columns: 1fr} }
      @media (max-width: 1200px) { article{ grid-template-columns: 1fr}  .producto{ height: 450px;} }
  
  
  
  </style>

</head>
<body>
  
  <div class="grid">
    <div id="toast"><div id="img"><i class="fa fa-plus boxicon " aria-hidden="true"></i></div><div id="desc">añadido exitosamente</div></div>
    <!-- Artículos -->
    <article id="items">
      
    </article>
  
    <aside class="sidebar-right">
      <!-- Login -->
      <section>
        <div id="boxCliente" class="asidebox userbox boxCliente">
          <div class="avatarbox">
              <img src="img/elie.jpg" data-demo-src="img/elie.jpg" alt="">
          </div>
          <div class="metadata">
              <span>Comprar como</span>
              <span>Elie Daniels</span>
          </div>
        </div>
        <div id="loginform" class="asidebox userbox login boxCliente">
          <span>Inicie Sesión</span>
          <form novalidate>
            <div class="boxinput">
              <i id="iuser" class="fa fa-user boxicon" aria-hidden="true"></i><input id="inuser" type="text" placeholder="nombre">
            </div>
            <div class="boxinput">
              <i id="ipass" class="fa fa-lock boxicon" aria-hidden="true"></i><input id="inpass" type="password" placeholder="contraseña" autocomplete="off">
            </div>
            <input type="button" class="btnagregar titleBtn" id="submit" value="Iniciar Sesión"> 
          </form>
        </div>
      </section>
      <!-- Carrito -->
      <section>
        <div class="asidebox cartbox">
          <div class="metadataCart titleCart">
            <span><i class="fa fa-shopping-basket boxicon boxshop" aria-hidden="true"></i> Carrito</span>
          </div>
          
   
          <!-- Listado de Artículos -->
          
            <ul id="carrito"></ul>
                
               
          
          <!-- Detalle Compra -->
          <div class="asideboxArticuloDetalle">
            <div class="carticonbox">
               <span class="metadataCart titleDetalle titleCart"><i class="fa fa-shopping-cart boxicon boxshop" aria-hidden="true"></i> <span id="totalitm" class="cartNumber">0</span> Artículo(s) en Carrito</span>
            </div>
          </div>
          <div class="asideboxArticuloDetalle userbox">
            <div class="metadataArticulo">
              <span>Total de Artículos </span>
           </div>
            <div>
              <span id="totalArticulos" class="precioDetalle">$0</span>
            </div>
          </div>
          <div class="asideboxArticuloDetalle userbox">
            <div class="metadataArticulo">
              <span>Envío </span>
           </div>
            <div>
              <span id="costoenv" class="precioDetalle">$0</span>
            </div>
          </div>
          
          <div class="asideboxArticuloDetalle userbox">
            <div class="metadataArticulo">
              <span class="precioTotal">Total a Comprar </span>
           </div>
            <div>
              <span id="totalcompra" class="precioDetalle precioTotal">$0</span>
            </div>
          </div>
          <!-- Botón Comprar -->
          <div class="asideboxArticuloDetalle">
            <div class="carticonbox">
              <button class="boxCliente btnagregado titleBtn" id="btnRComprar" type="submit" disabled>Realizar Compra</button>
            </div>
          </div>
          <!-- Mensaje Compra Exitosa -->
          <div id="msgCustom" class="asideboxArticuloDetalle boxCliente">
            <div class="carticonbox">
              <span><i id="imsg" class="fa fa-check-circle boxicon boxshop boxcheck" aria-hidden="true"></i></span>
            </div>
            <div class="carticonbox titleBtn titleCompra ">
              <span id="msgCompra" >¡Gracias por tu compra!</span>
            </div>
          </div>
        </div>
      </section>
      <!-- Datos Desarrollo -->
      <section>
        <div class="asidebox userbox">
          <div class="login-accounts-panel is-active">
            <div class="panel-inner">
                <div class="header">
                    <h3>Datos para desarrollo</h3>
                    <p class="headerp">Use la siguiente credencial para iniciar sesión</p>
                </div>
                <!--Block-->
                <div class="login-block">
                    <img id="imgDev" src="img/elie.jpg" data-demo-src="img/elie.jpg" alt="">
                    <div class="meta">
                        <span>
                                <label class="flbl">Email: </label>
                                <span id="emailTxt" >elie@mail.com</span><br />
                        </span>
                        <span>
                                <label class="flbl">Password: </label>
                                <span id="passTxt">testpassword</span>
                        </span>
                    </div>
                </div>
                <div class="carticonbox">
                  <button id="boton-vaciar" class="btnagregar titleBtn">Restaurar productos</button>
                  <button id="boton-vaciar-stock" type="submit" class="btnagregar titleBtn boxCliente">vaciar stock</button>
                </div>
            </div>
          </div>
        </div>
      </section>
    </aside>
  </div>
   <script>
    'use strict';

    let islogged = false;
    let inuser = document.getElementById('inuser');
    let inpass = document.getElementById('inpass');
    let emailtxt = document.getElementById('emailTxt');
    let imgdev = document.getElementById('imgDev');
    let passtxt = document.getElementById('passTxt');
    let btadd = document.querySelectorAll('.btnCrt');
    let submited = document.getElementById('submit');
    let btnall = document.getElementsByTagName('button');
    let comprado = false;
    
    
    

    for (let i = 0; i < btadd.length; i++) {
        btadd[i].addEventListener('click', function(event) {
            btadd[i].classList.remove("btnagregar");
            btadd[i].classList.add("btnagregado");
            btadd[i].setAttribute('disabled', '');
            btadd[i].innerHTML = ('<i class="fa fa-shopping-basket boxicon" aria-hidden="true"></i> Agregado en el carrito');
            msgtoasty(0);
        });
    }

  
    

    document.addEventListener('click', function(event) {
    event.preventDefault();

    let isUserClicked = inuser.contains(event.target);
    let isPassClicked = inpass.contains(event.target);
    let isEmailClicked = emailtxt.contains(event.target);
    let isImgClicked = imgdev.contains(event.target);
    let isInPassClicked = passtxt.contains(event.target);
    let isSubmitedClicked = submited.contains(event.target);
   

    if (!isUserClicked) {
      document.getElementById("iuser").classList.remove("bluecolor"); 
    } else {
      document.getElementById("iuser").classList.add("bluecolor"); 
    }

    if (!isPassClicked) {
        document.getElementById("ipass").classList.remove("bluecolor"); 
      } else {
        document.getElementById("ipass").classList.add("bluecolor"); 
      }
    
    if (isEmailClicked || isImgClicked || isInPassClicked) {
      document.getElementById('inuser').value = "elie@mail.com";
      document.getElementById('inpass').value = "testpassword";
    } 

    if (isSubmitedClicked) {
      validarLogin();
    }
    });

    function launch_toast() {
      let x = document.getElementById("toast")
      x.className = "show";
      setTimeout(function(){ x.className = x.className.replace("show", ""); }, 2000);
    }

    function msgtoasty(n) {
      let p = new Promise(function (resolve, reject) {
         if ( n == 1 ) {
          document.getElementById('toast').style.backgroundColor = 'black';
          document.getElementById('img').style.backgroundColor = 'black';
          document.getElementById('img').innerHTML = '<i class="fa fa-meh-o boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "Usuario no encontrado";
          
            resolve(launch_toast());
         } else if ( n == 0 ) {
          document.getElementById('toast').style.backgroundColor = '#0023ff';
          document.getElementById('img').style.backgroundColor = '#0023ff';
          document.getElementById('img').innerHTML = '<i class="fa fa-plus boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "añadido exitosamente";
          resolve(launch_toast());
         } else if ( n == 3 ) {
          document.getElementById('toast').style.backgroundColor = '#0023ff';
          document.getElementById('img').style.backgroundColor = '#0023ff';
          document.getElementById('img').innerHTML = '<i class="fa fa-check boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "logueado exitosamente";
          resolve(launch_toast());
         } else if ( n == 4 ) {
          document.getElementById('toast').style.backgroundColor = 'black';
          document.getElementById('img').style.backgroundColor = 'black';
          document.getElementById('img').innerHTML = '<i class="fa fa-check boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "máximo alcanzado";
          resolve(launch_toast());
         } else if ( n == 5 ) {
          document.getElementById('toast').style.backgroundColor = '#0023ff';
          document.getElementById('img').style.backgroundColor = '#0023ff';
          document.getElementById('img').innerHTML = '<i class="fa fa-smile-o boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "Compra exitosa";
          resolve(launch_toast());
         } else if ( n == 6 ) {
          document.getElementById('toast').style.backgroundColor = '#0023ff';
          document.getElementById('img').style.backgroundColor = '#0023ff';
          document.getElementById('img').innerHTML = '<i class="fa fa-check-circle boxicon" aria-hidden="true"></i>';
          document.getElementById('desc').innerHTML = "Restaurado";
          resolve(launch_toast());
         } else
            reject('Error de ejecución')
      })
      return p;
    }

      function validarLogin(){
    
        let correo = inuser.value;
        let clave = inpass.value;

        if ( correo == "elie@mail.com" && clave == "testpassword") {
    
          sessionStorage.setItem("islogged", "true");

          document.getElementById('loginform').style.display = "none";
          document.getElementById('boxCliente').classList.remove('boxCliente');
          document.getElementById('btnRComprar').classList.remove('boxCliente');
          document.getElementById('btnRComprar').classList.remove('boxCliente');
          
          validarCarrito();

          msgtoasty(3);
          
          
        } else {
          msgtoasty(1);
        }
      }

      function validarCarrito() {
        const DOMtotal = document.querySelector('#totalArticulos');
          if (DOMtotal.textContent !=  "$0") {
            document.getElementById('btnRComprar').classList.remove("btnagregado");
            document.getElementById('btnRComprar').classList.add("btnagregar");
            document.getElementById('btnRComprar').disabled = false;
          } else {
            document.getElementById('btnRComprar').classList.remove("btnagregar");
            document.getElementById('btnRComprar').classList.add("btnagregado");
            document.getElementById('btnRComprar').disabled = true;
          }
      }

      
      function desactivarBotones() {
        const btns = Object.keys(btnall);
        btns.forEach((key, index) => {
          btnall[key].disabled = true;
        });
      }

      function activarBotones() {
        const btns = Object.keys(btnall);
        btns.forEach((key, index) => {
          btnall[key].disabled = false;
        });
      }

      function changeIcon(n){
        if ( n === 2) {
          document.getElementById('imsg').classList.remove('fa-exchange', 'fa-spinner', 'fa-pulse', 'fa-3x');
          document.getElementById('imsg').classList.add('fa-check-circle');
          document.getElementById('msgCompra').textContent = "Compra Exitosa";
        } else if ( n === 1 ) {
          document.getElementById('imsg').classList.remove('fa-check-circle');
          document.getElementById('imsg').classList.add('fa-spinner', 'fa-pulse', 'fa-3x');
          document.getElementById('msgCompra').textContent = "Realizando Transacción";
        }
      }
    

        let p = new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve(changeIcon(1));
            }, 3 * 1000);
        });

      

      function transaccion() {
         
          p.then((result) => {
               
              return new Promise((resolve, reject) => {
                  setTimeout(() => {
                      resolve();
                  }, 0);
              });
          }).then((result) => {
               
              return new Promise((resolve, reject) => {
                  setTimeout(() => {
                      resolve(changeIcon(2), msgtoasty(5));
                  }, 3 * 1000);
              });
          }).then((result) => { 
              return new Promise((resolve, reject) => {
                  setTimeout(() => {
                      resolve(activarBotones(), DOMbotonVaciarX.click());
                  }, 2 * 1000 );
              });
            });
      }
    

     function prevenirActualizar() {
      document.addEventListener('keydown', (e) => {
          e = e || window.event;
          if(e.keyCode == 116 || e.keyCode == 82){
              e.preventDefault();
          }
      });
    }
      
    
      function disableClicks() {
        cont.style.pointerEvents = "none";
      }

      function enableClicks() {
        cont.style.pointerEvents = "auto";
      }
      const DOMbotonVaciarX = document.querySelector('#boton-vaciar-stock');

      window.addEventListener('DOMContentLoaded', function() {
        
        
        document.getElementById('btnRComprar').addEventListener("click", () => {
        document.getElementById('btnRComprar').classList.add('boxCliente');
        desactivarBotones()
        prevenirActualizar();
        document.getElementById('imsg').classList.add('fa-exchange');
        document.getElementById('msgCustom').classList.remove('boxCliente');
        changeIcon(1);
        transaccion();
        comprado=true;
       
        
      });
    });

  
     

    window.onload = (event) => {
      if ( sessionStorage.getItem("islogged") == "true" ){
        document.getElementById('loginform').classList.add = "boxCliente";
        document.getElementById('boxCliente').classList.remove('boxCliente');
        document.getElementById('btnRComprar').classList.remove('boxCliente');
       
      } else {
        document.getElementById('loginform').classList.remove("boxCliente");
      }

      

      function formatNumber (n) {
                n = String(n).replace(/\D/g, "");
            return n === '' ? n : Number(n).toLocaleString();
      }
  
      let carrito = [];
      let stock = [];
      let total = 0;
      const envioclp = 1500;
      const productoclp = 350;
      let envclp = 0;
      let totalacomprar = 0;
      let totalitem = 0;
      let max = Infinity;
      
     
      
    //JSON=>Articulos
    const baseDeDatos = [
                {
                    id: 1,
                    titulo: 'Silla Gamer Color Rojo',
                    precio: 249990,
                    imagen: 'img/s1.jpg',
                    stock: 2
                },
                {
                    id: 2,
                    titulo: 'Silla Gamer Color Celeste',
                    precio: 169900,
                    imagen: 'img/s2.jpg',
                    stock: 3
                },
                {
                    id: 3,
                    titulo: 'Silla Gamer Color Rosada',
                    precio: 134900,
                    imagen: 'img/s3.jpg',
                    stock: 4
                },
                {
                    id: 4,
                    titulo: 'Silla Gamer Color Blanca',
                    precio: 159900,
                    imagen: 'img/s4.jpg',
                    stock: 5
                },
                {
                    id: 5,
                    titulo: 'Silla Gamer Color Azul',
                    precio: 149900,
                    imagen: 'img/s5.jpg',
                    stock: 5
                },
                {
                    id: 6,
                    titulo: 'Silla Gamer Color Verde',
                    precio: 119900,
                    imagen: 'img/s6.jpg',
                    stock: 5
                }

            ];

            const DOMitems = document.querySelector('#items');
            
            const DOMcarrito = document.querySelector('#carrito');
            const DOMtotal = document.querySelector('#totalArticulos');
            const DOMcostoenvio = document.querySelector('#costoenv');
            const DOMtotalcompra = document.querySelector('#totalcompra');
            const DOMtotalitems = document.querySelector('#totalitm');
            const DOMbtncomprar = document.querySelector('#btnRComprar');
            const DOMbotonVaciar = document.querySelector('#boton-vaciar');
            const DOMbotonVaciarX = document.querySelector('#boton-vaciar-stock');
            const miLocalStorage = window.localStorage;
            const miStockStorage = window.localStorage;

            
            

            
            

            // Funciones

            /**
             * Revisa la flag comprado
             */
            function flagComprado() {
              if (comprado){
                document.getElementById('msgCustom').classList.add("boxCliente");
                document.getElementById('msgCompra').textContent = '';
                document.getElementById('btnRComprar').classList.remove("boxCliente");
              }
            }

            /**
             * sobrescribe el Stock del DOM usando como base el Stock del LS 
             */

            function recorreStock() { 

              //si hay una compra realizada, entonces esto correrá

              if (comprado) { 

              //este total lo usaremos para almacenar las veces que se repite el stock del LS 
              total = 0;

              //obtenemos sólo los valores desde el LS
              const  obj = JSON.parse(miStockStorage['stock']);

              //ahora generamos un nuevo Stock sin Duplicados
              const stockSinDuplicados = [...new Set(obj)];

              // Recorremos uno a uno cada item del nuevo Stock
              stockSinDuplicados.forEach((item) => {
                
              // Cuenta el número de veces que se repite el item
              const numeroUnidadesItem = obj.reduce((total, itemId) => {
                
                  // ¿Coinciden las id? entonces decremento el contador, en caso contrario lo mantengo
                  //itemId es obtenido del objeto que almacena el current StockLS
                  //item  es el id que estamos comparando
                  //total es un valor previamente establecimos en valor 0
                  //Si coinciden los ID de los ítem, entonces disminuye 1, lo cual dará un número negativo al final
                  if (itemId === item) {
                    total -= 1; 
                    return total;
                  }else{
                    return total;
                  } 
                }, 0);
                
       
                //definimos nuestro prefijo
                const prefijo = "stock-";
                
                //concatenamos con el id del item que estamos usando
                const idDOM = prefijo.concat(item);
                
                //leemos el stock disponible del elemento
                let DOMstock = document.getElementById(idDOM).textContent;

                // nuevo code START
                //realizamos una comparación estricta para saber si son iguales los valores
                    
                    // if ( Number(max) === Number(DOMstock) ) {
                      //en caso de ser iguales definimos el stock máximo del JSON
                      // max;
                    // } else {
                      //en caso contrario seteamos el nuevo valor máximo por medio de una resta
                      // max = Number(max) - Number(DOMstock); 
                    // }
                // nuevo code END
                
                //realizamos la operación matemática de restar, pero primero nos aseguramos de estar trabajando con valores númericos
                //usamos un objeto primitivo, Number

                let nuevoStock = Number(DOMstock) + Number(numeroUnidadesItem);

                  //escribimos el nuevo valor del stock en el DOM
                  document.getElementById(idDOM).textContent = nuevoStock;
                  console.log(nuevoStock);

                })
              }

              }

            /**
            * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
            * Cuando presiono F5 sigue apareciendo el valor del JSONN en unidades disponibles, debería saler el valor de la restar entre db.stock - ls.stock
            * El LS stock si se mantienen en Application
            */

            function renderizarProductos() {
                
           
                
                //tomamos los datos desde el JSON y dibujamos el DOM de productos

                baseDeDatos.forEach((info) => {
                    // Estructura
                    const miNodo = document.createElement('section');
                    miNodo.classList.add('producto');
                    
                    // Body
                    const miNodoCardBody = document.createElement('figure');
                    
                    // Titulo
                    const miNodoTitle = document.createElement('figcaption');

                    // miNodoTitle.classList.add('card-title');
                    miNodoTitle.textContent = info.titulo;
                    
                    // Imagen
                    const miNodoImagen = document.createElement('img');
                    miNodoImagen.setAttribute('src', info.imagen);
                    
                    // Precio
                    const miNodoPrecio = document.createElement('span');
                    miNodoPrecio.classList.add('precio');
                    miNodoPrecio.textContent = `$ ${formatNumber(info.precio)}`;
                    
                    // Stock
                    const miNodoStock = document.createElement('p');
                    miNodoStock.classList.add('stock');
                    
                    miNodoStock.innerHTML = `<span class="numCart" id="stock-${info.id}">${info.stock}</span> unidades disponibles`;
                    
                    // Boton 
                    const miNodoBoton = document.createElement('button');
                    miNodoBoton.classList.add('btnCrt', 'btnagregar');

                    // consultamos si hay un proceso de compra, en caso de ser positivo, desactivamos los botones por prevención
                    if (comprado ) {
                      miNodoBoton.setAttribute.disabled = true;
                    }
                    miNodoBoton.textContent = 'Añadir al carrito';
                    miNodoBoton.setAttribute('marcador', info.id);

                    // Unidades disponibles
                    const miNodoDisponibles = document.createElement('p');
                    miNodoDisponibles.classList.add('encarrito');
                    miNodoDisponibles.innerHTML = `Tiene <span class="numCart" id="art-${info.id}"><b>0</b></span> unidades en el carrito de compras`;
                    miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);


                    // Insertamos
                    miNodoCardBody.appendChild(miNodoImagen);
                    miNodoCardBody.appendChild(miNodoTitle);
                    miNodoCardBody.appendChild(miNodoPrecio);
                    miNodoCardBody.appendChild(miNodoStock);
                    miNodoCardBody.appendChild(miNodoBoton);
                    miNodoCardBody.appendChild(miNodoDisponibles);
                    miNodo.appendChild(miNodoCardBody);
                    DOMitems.appendChild(miNodo);
                });
                
                    //Buscamos en nuestro StockLocalStorage los descuentos de Stock y recorreremos el DOM Productos para establecer el nuevo Stock disponible
                    try {
                      recorreStock();  
                      } catch (error) {
                      console.log(error)
                      }

                }

             
            /**
            * Evento para añadir un producto al carrito de la compra
            */
            function anyadirProductoAlCarrito(evento) {
              let total = 0;

              //establecemos las clases CSS, mientras sucede esta operación
              flagComprado();

              const carritoSinDuplicados = [...new Set(carrito)];

              // Cuenta el número de veces que se repite el producto
              const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                      
                      // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo

                      // Obtenemos stock del item
                    let itemStock = [];

                     // Obtenemos el item que necesitamos de la variable base de datos
                     const miItemStock = baseDeDatos.filter((itemBaseDatos) => {

                        // ¿Coincide las id? Solo puede existir un caso
                       if ( itemBaseDatos.id === parseInt(itemId)){
                         itemStock = itemBaseDatos.stock;
                         return itemStock;
                       }
                        
                    });


                    let isJson = JSON.stringify(miItemStock);
                    let obj = JSON.parse(isJson);

                    //usamos la siguiente función para obtener el máximo de unidades disponibles desde el JSON
                    function printValues(obj) {
                        for(var k in obj) {
                            if(obj[k] instanceof Object) {
                              let num = obj[k].stock;
                              return num;
                            } else {
                              let num = obj[k].stock;
                              return num;
                            };
                        }
                    };

                    //traemos el valor actual de unidades disponibles desde el DOM, y comparamos
                    // Si son iguales, entonces se toma como valor máximo el obtenido del JSON
                    // En caso contrario, restamos  el stock de la DB con el stock del DOM y así obtenemos el nuevo valor máximo de stock disponible
                    //debemos asegurarnos de establecer el stock en el DOM después de comprar y luego volvemos acá
                    //valor del Stock inicial del JSON
                    max = printValues(obj);

                    //obtenemos el valor del stock del DOM
                    //definimos nuestro prefijo
                    const prefijo = "stock-";
                    
                    //concatenamos con el id del item que estamos usando en el DOM
                    const idDOM = prefijo.concat(itemId);
                    
                    //leemos el stock disponible del elemento
                    let DOMstock = document.getElementById(idDOM).textContent;
                    


                    //realizamos una comparación estricta para saber si son iguales los valores
                    
                    if ( Number(max) === Number(DOMstock) ) {
                      //en caso de ser iguales definimos el stock máximo del JSON
                      max;
                    } else {
                      //en caso contrario seteamos el nuevo valor máximo por medio de una resta
                      max = Number(max) - Number(DOMstock); 
                    }
                    
                      if (itemId === evento.target.getAttribute('marcador') && total < max) {
                        total += 1; 
                        return total;
                      }else{
                        return total;
                      } 
                  }, 0);

             
              
              // Añadimos el Nodo a nuestro carrito

              if ( numeroUnidadesItem < max) {
              
                carrito.push(evento.target.getAttribute('marcador'));
                msgtoasty(0);

                // Calculo el total
                calcularTotal();
                // Actualizamos el carrito 
                renderizarCarrito();
                // Actualizamos el LocalStorage
                guardarCarritoEnLocalStorage();
              }else{
                msgtoasty(4);
                // Actualizamos el carrito 
                renderizarCarrito();
              }
            }

            /**
            * Dibuja todos los productos guardados en el carrito
            */
            function renderizarCarrito() {
                // Vaciamos todo el html
                DOMcarrito.textContent = '';
                // Quitamos los duplicados
                const carritoSinDuplicados = [...new Set(carrito)];
                // Generamos los Nodos a partir de carrito
                carritoSinDuplicados.forEach((item) => {
                    // Obtenemos el item que necesitamos de la variable base de datos
                    const miItem = baseDeDatos.filter((itemBaseDatos) => {
                        // ¿Coinciden las id? Solo puede existir un caso
                       
                        return itemBaseDatos.id === parseInt(item);
                    });

                    // Obtenemos stock del item
                    let itemStock = [];
                     // Obtenemos el item que necesitamos de la variable base de datos
                     const miItemStock = baseDeDatos.filter((itemBaseDatos) => {
                        // ¿Coincide las id? Solo puede existir un caso
                       if ( itemBaseDatos.id === parseInt(item)){
                         itemStock = itemBaseDatos.stock;
                         return itemStock;
                       }
                        
                    });


                    let isJson = JSON.stringify(miItemStock);
                    let obj = JSON.parse(isJson);

                    function printValues(obj) {
                        for(var k in obj) {
                            if(obj[k] instanceof Object) {
                              let num = obj[k].stock;
                              return num;
                            } else {
                              let num = obj[k].stock;
                              return num;
                            };
                        }
                    };
               
                 
                    // Cuenta el número de veces que se repite el producto
                    const numeroUnidadesItem = carrito.reduce((total, itemId, itemStock) => {
                      
                    // ¿Coincide las id? Incremento el contador, en caso contrario lo mantengo
                        
                    if (itemId === item && total < printValues(obj)) {
                          total += 1; 
                          return total;
                        }else{
                          return total;
                        } 
                    }, 0);

                    let multiplicar = numeroUnidadesItem * miItem[0].precio;
                    
                    // Creamos el nodo del item del carrito
                    const miNodo = document.createElement('li');
                    miNodo.classList.add("userbox");
                    
                    miNodo.innerHTML = `<div class="asideboxArticulo userbox">
                            <div class="avatarcart">
                              <img src="${miItem[0].imagen}" data-demo-src="${miItem[0].imagen}" alt="">
                            </div>
                            <div class="metadataArticulo">
                                <span>${miItem[0].titulo}</span>
                                <span>$ ${formatNumber(miItem[0].precio)}</span>
                                <span>${numeroUnidadesItem} unidades</span>
                                <span>Total $ ${formatNumber(multiplicar)}  </span>  
                            </div>
                    </div>`;
                    
                    let id = `art-${miItem[0].id}`;
                    let encarrito = document.getElementById(id);
                    encarrito.textContent = numeroUnidadesItem;

                  
                    // Boton de borrar
                    const miBoton = document.createElement('button');
                    miBoton.classList.add("rock");
                    miBoton.dataset.item = item;
                    miBoton.addEventListener('click', borrarItemCarrito);
                   // Mezclamos nodos
                    miNodo.appendChild(miBoton);
                    DOMcarrito.appendChild(miNodo);
                  
                  
                    if ( sessionStorage.getItem("islogged") == "true"){
                      DOMbtncomprar.classList.remove("btnagregado");
                      DOMbtncomprar.classList.add("btnagregar", "titleBtn");
                      DOMbtncomprar.disabled = false;
                    }
                    
                });
            }

            /**
            * Evento para borrar un elemento del carrito
            */
            function borrarItemCarrito(evento) {
                // Obtenemos el producto ID que hay en el boton pulsado
                const id = evento.target.dataset.item;
                // Borramos todos los productos
                carrito = carrito.filter((carritoId) => {
                    return carritoId !== id;
                });

                
                // volmemos a renderizar los productos
                renderizarProductos();

                // volvemos a renderizar
                renderizarCarrito();
                // Calculamos de nuevo el precio
                calcularTotal();
                // Actualizamos el LocalStorage
                guardarCarritoEnLocalStorage();
                validarCarrito();

                

            }

            /**
            * Calcula el precio total teniendo en cuenta los productos repetidos
            */
            function calcularTotal() {
                // Limpiamos precio anterior
                total = 0;
                totalacomprar = 0;
                totalitem = 0;
                
                // Recorremos el array del carrito

                carrito.forEach((item) => {   
                  
                    // De cada elemento obtenemos su precio
                    const miItem = baseDeDatos.filter((itemBaseDatos) => {
                        return itemBaseDatos.id === parseInt(item);
                    });
                   
                      total = total + miItem[0].precio;
                   
                });

                 
                if ( carrito.length == 0 ) {
                  envclp = 0;
                } else {
                  envclp = envioclp + (productoclp * carrito.length);
                  totalacomprar = envclp + total;
                }
 
                // Renderizamos el precio en el HTML
                DOMtotal.textContent = `$${formatNumber(total.toFixed(0))}`;
                DOMcostoenvio.textContent = `$${formatNumber(envclp.toFixed(0))}`;
                DOMtotalcompra.textContent = `$${formatNumber(totalacomprar.toFixed(0))}`;
                DOMtotalitems.textContent = carrito.length;
                

            }

            /**
            * Vacia el carrito y vuelve a dibujarlo
            */
            function vaciarCarrito() {
                // Limpiamos los productos guardados
                carrito = [];
                comprado = false;
                

                // Limpiamos los productos del DOM
                // Vaciamos todo el html
                DOMitems.textContent = '';

                
                // Desactivamos el botón comprar
                
                if ( sessionStorage.getItem("islogged") == "true" ){
                  DOMbtncomprar.classList.remove("btnagregar", "titleBtn");
                  DOMbtncomprar.classList.add("btnagregado");
                  DOMbtncomprar.disabled = true;
                } else {
                  DOMbtncomprar.classList.add("boxCliente");
                }
               
                // volmemos a renderizar los productos

                renderizarProductos();
                
                // Renderizamos los cambios
                renderizarCarrito();
                // volmemos a renderizar los productos
             
                calcularTotal();
                // Borra LocalStorage
                localStorage.clear();

                msgtoasty(6);
                

            }

            /**
            * Vacia el carrito y descuenta el stock
            */
            function vaciarCarritoStock() {
                //guardamos el stock
                guardarStockEnLocalStorage();
                // Limpiamos los productos guardados
                carrito = [];
                flagComprado();
                
                // Limpiamos los productos del DOM
                // Vaciamos todo el html
                DOMitems.textContent = '';
                DOMtotal.textContent = '';

                
                // Desactivamos el botón comprar
                
                if ( sessionStorage.getItem("islogged") == "true" ){
                  DOMbtncomprar.classList.remove("btnagregar", "titleBtn");
                  DOMbtncomprar.classList.add("btnagregado");
                  DOMbtncomprar.disabled = true;
                } else {
                  DOMbtncomprar.classList.add("boxCliente");
                }
               
                // volmemos a renderizar los productos

                renderizarProductos();
                
                // Renderizamos los cambios
                renderizarCarrito();
                // volmemos a renderizar los productos
             
                calcularTotal();
                // Borra LocalStorage
               // localStorage.clear();
                

            }


            function guardarCarritoEnLocalStorage () {
              
                miLocalStorage.setItem('carrito', JSON.stringify(carrito));
            }
 

            function guardarStockEnLocalStorage () {
           
              
                  let cloneCarrito = JSON.stringify(carrito);
                  
                    miStockStorage.setItem('stock', cloneCarrito);
                    miLocalStorage.removeItem('carrito');

            }

            function cargarCarritoDeLocalStorage () {
                // ¿Existe un carrito previo guardado en LocalStorage?
                if (miLocalStorage.getItem('carrito') !== null) {
                    // Carga la información
                    carrito = JSON.parse(miLocalStorage.getItem('carrito'));
                }
            }

            // Eventos
            DOMbotonVaciar.addEventListener('click', vaciarCarrito);
            DOMbotonVaciarX.addEventListener('click', vaciarCarritoStock);

            //Inicio
    
            validarCarrito();
            cargarCarritoDeLocalStorage();
            renderizarProductos();
            calcularTotal();
            renderizarCarrito();
            recorreStock();
            

      
    };

  
   </script>
</body>
</html>